<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>거절된 게시글</title>
    <link rel="stylesheet" href="/style/admin.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
</head>
<body>
    <div class="admin-container">
        <header class="admin-header">
            <h1><i class="fas fa-times-circle"></i> 거절된 게시글</h1>
            <nav class="admin-nav">
                <a href="/admin/dashboard">대시보드</a>
                <a href="/admin/pending">승인 대기</a>
                <a href="/admin/approved">승인된 게시글</a>
                <a href="/admin/rejected" class="active">거절된 게시글</a>
                <a href="/admin/all-offers">전체 게시글 관리</a>
                <a href="/" class="home-link">홈으로</a>
            </nav>
        </header>

        <main class="admin-main">
            <section class="section">
                <div class="section-header">
                    <h2>거절된 게시글 목록</h2>
                    <p class="section-description">관리자가 거절한 게시글 목록입니다.</p>
                </div>

                <div class="offer-grid" th:if="${!offers.empty}">
                    <div class="offer-card rejected" th:each="offer : ${offers}">
                        <div class="offer-header">
                            <h3 th:text="${offer.perName}">담당자명</h3>
                            <span class="status rejected">거절됨</span>
                        </div>
                        <div class="offer-content">
                            <p><strong>작성자:</strong> <span th:text="${offer.author.nickname}">작성자</span></p>
                            <p><strong>업종:</strong> <span th:text="${offer.type}">업종</span></p>
                            <p><strong>근무지:</strong> <span th:text="${offer.workPlace}">근무지</span></p>
                            <p><strong>담당자:</strong> <span th:text="${offer.perName}">담당자</span></p>
                            <p><strong>전화번호:</strong> <span th:text="${offer.phone}">전화번호</span></p>
                            <p><strong>등록일:</strong> <span th:text="${#temporals.format(offer.createDate, 'yyyy-MM-dd HH:mm')}">등록일</span></p>
                        </div>
                        <div class="offer-actions">
                            <button class="btn-view" th:onclick="'viewOffer(' + ${offer.id} + ')'">
                                <i class="fas fa-eye"></i> 상세보기
                            </button>
                            <button class="btn-delete" th:onclick="'deleteOffer(' + ${offer.id} + ')'">
                                <i class="fas fa-trash"></i> 삭제
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="empty-state" th:if="${offers.empty}">
                    <i class="fas fa-inbox"></i>
                    <p>거절된 게시글이 없습니다.</p>
                    <a href="/admin/dashboard" class="btn-primary">대시보드로 돌아가기</a>
                </div>
            </section>
        </main>
    </div>

    <script>
        function deleteOffer(id) {
            if (confirm('이 게시글을 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다.')) {
                const csrfToken = document.querySelector('meta[name="_csrf"]').getAttribute('content');
                const csrfHeader = document.querySelector('meta[name="_csrf_header"]').getAttribute('content');
                fetch(`/admin/delete/${id}`, {
                    method: 'POST',
                    headers: {
                        [csrfHeader]: csrfToken
                    }
                })
                .then(response => {
                    if (response.ok) {
                        alert('게시글이 삭제되었습니다.');
                        location.reload();
                    } else {
                        alert('삭제 처리 중 오류가 발생했습니다.');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('삭제 처리 중 오류가 발생했습니다.');
                });
            }
        }

        function viewOffer(id) {
            window.open(`/offer/detail/${id}`, '_blank');
        }
    </script>
</body>
</html> 